# ğŸ“Š é¡¹ç›®æ€»ç»“ï¼šQuestionAgent å®¢æˆ·è®¿è°ˆç³»ç»Ÿ

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

**QuestionAgent** æ˜¯åŸºäºé˜¶è·ƒæ˜Ÿè¾° Realtime API å¼€å‘çš„æ™ºèƒ½è¯­éŸ³è®¿è°ˆç³»ç»Ÿï¼Œç”¨äºå‘å®¢æˆ·æé—®å¹¶è‡ªåŠ¨è®°å½•å›ç­”ã€‚

### æ ¸å¿ƒç‰¹ç‚¹
- ğŸ¤ **çœŸå®è¯­éŸ³äº¤äº’** - è‡ªç„¶çš„å¯¹è¯ä½“éªŒ
- ğŸ“‹ **ç»“æ„åŒ–æé—®** - YAML é…ç½®é—®é¢˜åˆ—è¡¨
- ğŸ“ **è‡ªåŠ¨è®°å½•** - è¯­éŸ³è½¬å†™ + åŒæ ¼å¼ä¿å­˜
- ğŸ”„ **çµæ´»é…ç½®** - å¤šç§åœºæ™¯æ¨¡æ¿

## ğŸ“ é¡¹ç›®ç»“æ„

```
questionAgent/
â”œâ”€â”€ æ ¸å¿ƒæ–‡ä»¶
â”‚   â”œâ”€â”€ interview_client.py      # è®¿è°ˆå®¢æˆ·ç«¯ï¼ˆä¸»ç¨‹åºï¼‰
â”‚   â”œâ”€â”€ question_manager.py      # é—®é¢˜ç®¡ç† + ä¼šè¯è®°å½•
â”‚   â””â”€â”€ questions.yaml           # é»˜è®¤é—®é¢˜é…ç½®
â”‚
â”œâ”€â”€ æ–‡æ¡£
â”‚   â”œâ”€â”€ README.md                # å®Œæ•´ä½¿ç”¨æ–‡æ¡£
â”‚   â”œâ”€â”€ QUICKSTART.md            # 3åˆ†é’Ÿå¿«é€Ÿå¼€å§‹
â”‚   â””â”€â”€ PROJECT_SUMMARY.md       # æœ¬æ–‡ä»¶
â”‚
â”œâ”€â”€ ç¤ºä¾‹æ¨¡æ¿
â”‚   â””â”€â”€ examples/
â”‚       â”œâ”€â”€ product_feedback.yaml      # äº§å“åé¦ˆæ¨¡æ¿
â”‚       â”œâ”€â”€ service_evaluation.yaml    # æœåŠ¡è¯„ä»·æ¨¡æ¿
â”‚       â”œâ”€â”€ requirement_survey.yaml    # éœ€æ±‚è°ƒç ”æ¨¡æ¿
â”‚       â””â”€â”€ employee_onboarding.yaml   # å‘˜å·¥å…¥èŒæ¨¡æ¿
â”‚
â”œâ”€â”€ è„šæœ¬
â”‚   â””â”€â”€ scripts/
â”‚       â””â”€â”€ interview.sh         # ä¸€é”®å¯åŠ¨è„šæœ¬
â”‚
â””â”€â”€ é…ç½®
    â”œâ”€â”€ pyproject.toml           # é¡¹ç›®ä¾èµ–
    â””â”€â”€ .gitignore               # Git å¿½ç•¥è§„åˆ™
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…
```bash
cd /Users/town/code4/questionAgent
uv sync
```

### 2. é…ç½®
```bash
export STEPFUN_API_KEY='your-api-key'
```

### 3. è¿è¡Œ
```bash
# ä½¿ç”¨é»˜è®¤é—®é¢˜
uv run python interview_client.py

# æˆ–ä½¿ç”¨è„šæœ¬
./scripts/interview.sh

# æˆ–ä½¿ç”¨ç¤ºä¾‹æ¨¡æ¿
cp examples/product_feedback.yaml questions.yaml
uv run python interview_client.py
```

## ğŸ’¡ æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

### 1. QuestionManagerï¼ˆé—®é¢˜ç®¡ç†å™¨ï¼‰
**æ–‡ä»¶**: `question_manager.py`

**åŠŸèƒ½**:
- ä» YAML åŠ è½½é—®é¢˜åˆ—è¡¨
- ç®¡ç†é—®é¢˜é˜Ÿåˆ—å’Œè¿›åº¦
- æä¾›æ¬¢è¿è¯­å’Œç»“æŸè¯­

**å…³é”®ç±»**:
```python
class QuestionManager:
    - load_questions()      # åŠ è½½é—®é¢˜
    - get_next_question()   # è·å–ä¸‹ä¸€é¢˜
    - has_next_question()   # æ˜¯å¦è¿˜æœ‰é—®é¢˜
    - get_current_progress()  # è·å–è¿›åº¦
```

### 2. SessionRecorderï¼ˆä¼šè¯è®°å½•å™¨ï¼‰
**æ–‡ä»¶**: `question_manager.py`

**åŠŸèƒ½**:
- è®°å½•æ¯ä¸ªé—®ç­”å¯¹
- ä¿å­˜ JSON å’Œæ–‡æœ¬ä¸¤ç§æ ¼å¼
- è‡ªåŠ¨åˆ›å»ºä¼šè¯ç›®å½•

**è¾“å‡ºæ–‡ä»¶**:
```
sessions/20241118_143052/
â”œâ”€â”€ session.json    # è¯¦ç»†è®°å½•ï¼ˆJSONï¼‰
â””â”€â”€ summary.txt     # æ–‡æœ¬æ‘˜è¦
```

### 3. InterviewClientï¼ˆè®¿è°ˆå®¢æˆ·ç«¯ï¼‰
**æ–‡ä»¶**: `interview_client.py`

**åŠŸèƒ½**:
- WebSocket è¿æ¥ç®¡ç†
- å®æ—¶éŸ³é¢‘å½•åˆ¶å’Œæ’­æ”¾
- é—®ç­”æµç¨‹æ§åˆ¶
- äº‹ä»¶å¤„ç†

**æ ¸å¿ƒæ–¹æ³•**:
```python
class InterviewClient:
    - connect()           # å»ºç«‹è¿æ¥
    - start_interview()   # å¼€å§‹è®¿è°ˆ
    - _ask_question()     # æé—®å¹¶ç­‰å¾…
    - _complete_interview()  # å®Œæˆå¹¶ä¿å­˜
```

## ğŸ¯ ä½¿ç”¨åœºæ™¯å’Œæ¨¡æ¿

### 1. äº§å“åé¦ˆï¼ˆproduct_feedback.yamlï¼‰
- âœ… æ”¶é›†ç”¨æˆ·æ»¡æ„åº¦
- âœ… äº†è§£åŠŸèƒ½ä½¿ç”¨æƒ…å†µ
- âœ… å‘ç°äº§å“é—®é¢˜
- âœ… æ”¶é›†æ”¹è¿›å»ºè®®

### 2. æœåŠ¡è¯„ä»·ï¼ˆservice_evaluation.yamlï¼‰
- âœ… å®¢æœè´¨é‡è¯„ä¼°
- âœ… å”®åæœåŠ¡å›è®¿
- âœ… é—®é¢˜è§£å†³æƒ…å†µ
- âœ… æœåŠ¡æµç¨‹æ”¹è¿›

### 3. éœ€æ±‚è°ƒç ”ï¼ˆrequirement_survey.yamlï¼‰
- âœ… å¸‚åœºéœ€æ±‚åˆ†æ
- âœ… ç”¨æˆ·ç—›ç‚¹æŒ–æ˜
- âœ… åŠŸèƒ½ä¼˜å…ˆçº§æ’åº
- âœ… ä»·æ ¼æ¥å—åº¦è°ƒæŸ¥

### 4. å‘˜å·¥å…¥èŒï¼ˆemployee_onboarding.yamlï¼‰
- âœ… å…¥èŒä½“éªŒåé¦ˆ
- âœ… åŸ¹è®­æ•ˆæœè¯„ä¼°
- âœ… å›¢é˜Ÿèå…¥æƒ…å†µ
- âœ… HRæµç¨‹ä¼˜åŒ–

## ğŸ“Š æ•°æ®æµç¨‹

```
1. å¯åŠ¨ç³»ç»Ÿ
   â†“
2. åŠ è½½é—®é¢˜åˆ—è¡¨ï¼ˆquestions.yamlï¼‰
   â†“
3. å»ºç«‹ WebSocket è¿æ¥
   â†“
4. æ’­æ”¾æ¬¢è¿è¯­
   â†“
5. å¾ªç¯æé—®ï¼š
   - AI è¯­éŸ³æé—®
   - ç”¨æˆ·è¯­éŸ³å›ç­”
   - Whisper è½¬å†™
   - ä¿å­˜åˆ° SessionRecorder
   â†“
6. æ’­æ”¾ç»“æŸè¯­
   â†“
7. ä¿å­˜ä¼šè¯è®°å½•ï¼š
   - sessions/{session_id}/session.json
   - sessions/{session_id}/summary.txt
```

## ğŸ”§ æŠ€æœ¯æ ˆ

- **è¯­è¨€**: Python 3.11+
- **API**: é˜¶è·ƒæ˜Ÿè¾° Realtime API
- **éŸ³é¢‘**: PyAudio (å½•åˆ¶/æ’­æ”¾)
- **é…ç½®**: PyYAML
- **åŒ…ç®¡ç†**: uv
- **éŸ³é¢‘æ ¼å¼**: PCM16, 24kHz, å•å£°é“

## ğŸ“ˆ ä¸ askagent çš„å¯¹æ¯”

| ç‰¹æ€§ | askagent | questionAgent |
|------|----------|---------------|
| å¯¹è¯æ¨¡å¼ | è‡ªç”±å¯¹è¯ | ç»“æ„åŒ–æé—® |
| é—®é¢˜ç®¡ç† | âŒ | âœ… YAMLé…ç½® |
| ä¼šè¯è®°å½• | âŒ | âœ… è‡ªåŠ¨ä¿å­˜ |
| æ‰“æ–­åŠŸèƒ½ | âœ… å®Œå…¨æ”¯æŒ | âš ï¸ å—é™ |
| ä½¿ç”¨åœºæ™¯ | æ—¥å¸¸èŠå¤©åŠ©æ‰‹ | å®¢æˆ·è®¿è°ˆ/è°ƒç ” |
| è¿›åº¦è·Ÿè¸ª | âŒ | âœ… å®æ—¶æ˜¾ç¤º |
| æ•°æ®å¯¼å‡º | âŒ | âœ… JSON + æ–‡æœ¬ |

## ğŸ¨ è‡ªå®šä¹‰æŒ‡å—

### ä¿®æ”¹é—®é¢˜åˆ—è¡¨
ç¼–è¾‘ `questions.yaml`ï¼š
```yaml
questions:
  - id: 1
    question: "æ‚¨çš„é—®é¢˜ï¼Ÿ"
    type: "open"  # open/yesno/choice
```

### è°ƒæ•´ VAD å‚æ•°
ç¼–è¾‘ `interview_client.py`ï¼š
```python
vad_threshold=0.5,              # çµæ•åº¦
vad_silence_duration_ms=700     # é™éŸ³æ—¶é•¿
```

### æ›´æ¢æ¨¡å‹
```python
model=ModelType.STEP_AUDIO_2_MINI.value  # æ›´å¿«ä½†ç¨å¼±
model=ModelType.STEP_AUDIO_2_THINK.value # æ›´å¼ºå¤§
```

### ä¿®æ”¹ AI è¡Œä¸º
ç¼–è¾‘ `_configure_session()` ä¸­çš„ `instructions`

## ğŸ“¦ ä¾èµ–è¯´æ˜

```toml
[dependencies]
websocket-client >= 1.9.0  # WebSocket é€šä¿¡
pyaudio >= 0.2.13          # éŸ³é¢‘å½•åˆ¶/æ’­æ”¾
numpy >= 1.24.0            # æ•°å€¼è®¡ç®—
soundfile >= 0.12.1        # éŸ³é¢‘æ–‡ä»¶å¤„ç†
pyyaml >= 6.0.1            # YAML é…ç½®è§£æ
```

## ğŸ” ç¯å¢ƒå˜é‡

```bash
# å¿…éœ€
STEPFUN_API_KEY='sk-xxx'

# å¯é€‰ï¼ˆæœªæ¥æ‰©å±•ï¼‰
INTERVIEW_TIMEOUT=120
INTERVIEW_MODEL=step-audio-2
```

## ğŸ“ è¾“å‡ºæ ¼å¼

### JSON æ ¼å¼ï¼ˆsession.jsonï¼‰
```json
{
  "session_id": "20241118_143052",
  "start_time": "2024-11-18T14:30:52",
  "end_time": "2024-11-18T14:38:15",
  "duration_seconds": 443,
  "total_questions": 8,
  "answers": [
    {
      "question_id": 1,
      "question_text": "é—®é¢˜å†…å®¹",
      "transcript": "å›ç­”å†…å®¹",
      "timestamp": "2024-11-18T14:31:05"
    }
  ]
}
```

### æ–‡æœ¬æ ¼å¼ï¼ˆsummary.txtï¼‰
```
============================================================
å®¢æˆ·è®¿è°ˆè®°å½•
ä¼šè¯ID: 20241118_143052
å¼€å§‹æ—¶é—´: 2024-11-18 14:30:52
============================================================

ã€é—®é¢˜ 1ã€‘
é—®é¢˜å†…å®¹

ã€å›ç­”ã€‘
å›ç­”å†…å®¹

------------------------------------------------------------
```

## âš¡ æ€§èƒ½ä¼˜åŒ–

1. **é™ä½å»¶è¿Ÿ**: `vad_silence_duration_ms=500`
2. **æé«˜ç¨³å®šæ€§**: `vad_threshold=0.6`
3. **ä½¿ç”¨ mini æ¨¡å‹**: å“åº”æ›´å¿«
4. **å‡å°‘é—®é¢˜æ•°**: å»ºè®®ä¸è¶…è¿‡ 15 ä¸ª

## ğŸ”® æœªæ¥æ‰©å±•æ–¹å‘

- [ ] æ”¯æŒéŸ³é¢‘æ–‡ä»¶ä¿å­˜
- [ ] å¤šè¯­è¨€æ”¯æŒ
- [ ] Web ç•Œé¢
- [ ] æ‰¹é‡è®¿è°ˆç®¡ç†
- [ ] æ•°æ®åˆ†æå’Œå¯è§†åŒ–
- [ ] æƒ…æ„Ÿåˆ†æ
- [ ] è‡ªåŠ¨ç”ŸæˆæŠ¥å‘Š

## ğŸ“ å‚è€ƒèµ„æº

- [é˜¶è·ƒæ˜Ÿè¾° Realtime API](https://platform.stepfun.com/docs/guide/realtime)
- [askagent é¡¹ç›®](../askagent/README.md)
- [YAML è¯­æ³•](https://yaml.org/)
- [PyAudio æ–‡æ¡£](https://people.csail.mit.edu/hubert/pyaudio/)

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

---

**åˆ›å»ºæ—¶é—´**: 2024-11-18  
**åŸºäº**: askagent v0.1.0  
**ä½œè€…**: questionAgent Team

